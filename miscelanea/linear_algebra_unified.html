<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Four Views of Linear Algebra</title>
    <style>
        :root {
            --color-row1: #2E86AB;
            --color-row2: #E63946;
            --color-row3: #1B7837;
            --color-solution: #F18F01;
            --color-transform: #762A83;
            --color-metric: #2E86AB;
            --color-bg: #FAFAFA;
            --color-card: #FFFFFF;
            --color-text: #333333;
            --color-muted: #666666;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--color-bg);
            color: var(--color-text);
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, var(--color-row1), var(--color-transform));
            color: white;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .intro-box {
            background: var(--color-card);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .system-display {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 1.3em;
            text-align: center;
            margin: 20px 0;
        }
        
        .view-section {
            background: var(--color-card);
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .view-header {
            padding: 20px 30px;
            color: white;
            font-size: 1.4em;
            font-weight: bold;
        }
        
        .view-header.row { background: var(--color-row1); }
        .view-header.column { background: var(--color-row2); }
        .view-header.transform { background: var(--color-transform); }
        .view-header.metric { background: var(--color-row3); }
        
        .view-content {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 900px) {
            .view-content {
                grid-template-columns: 1fr;
            }
        }
        
        .visualization {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            min-height: 350px;
        }
        
        .explanation {
            padding: 10px;
        }
        
        .explanation h3 {
            color: var(--color-text);
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .explanation p {
            margin-bottom: 15px;
            color: var(--color-muted);
        }
        
        .formula-box {
            background: linear-gradient(135deg, #667eea11, #764ba211);
            border-left: 4px solid var(--color-transform);
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
            font-family: 'Courier New', monospace;
        }
        
        .step-box {
            background: #e8f5e9;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .step-box.highlight {
            background: #fff3e0;
            border: 2px solid var(--color-solution);
        }
        
        canvas {
            display: block;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
        }
        
        .matrix {
            display: inline-block;
            font-family: 'Courier New', monospace;
            vertical-align: middle;
        }
        
        .matrix-bracket {
            display: inline-flex;
            align-items: center;
            padding: 5px;
        }
        
        .matrix-content {
            display: grid;
            gap: 5px;
            padding: 0 10px;
            border-left: 2px solid var(--color-text);
            border-right: 2px solid var(--color-text);
        }
        
        .matrix-content.cols-2 { grid-template-columns: repeat(2, 40px); }
        .matrix-content.cols-1 { grid-template-columns: 40px; }
        
        .matrix-content span {
            text-align: center;
            padding: 5px;
        }
        
        .unified-section {
            background: linear-gradient(135deg, #667eea22, #764ba222);
            border-radius: 12px;
            padding: 40px;
            margin-bottom: 30px;
        }
        
        .unified-section h2 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--color-transform);
        }
        
        .four-views-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 700px) {
            .four-views-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .view-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid;
        }
        
        .view-card.row { border-color: var(--color-row1); }
        .view-card.column { border-color: var(--color-row2); }
        .view-card.transform { border-color: var(--color-transform); }
        .view-card.metric { border-color: var(--color-row3); }
        
        .view-card h4 {
            margin-bottom: 10px;
        }
        
        .eigenvalue-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .eigenvalue-table th, .eigenvalue-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .eigenvalue-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        
        .genetics-section {
            background: var(--color-card);
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .genetics-section h2 {
            color: var(--color-row3);
            margin-bottom: 20px;
        }
        
        .key-insight {
            background: linear-gradient(135deg, #4CAF5022, #8BC34A22);
            border: 2px solid var(--color-row3);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }
        
        .key-insight p {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--color-row3);
        }
        
        .rules-section {
            background: var(--color-card);
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .rule-item {
            display: flex;
            align-items: flex-start;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .rule-number {
            background: var(--color-transform);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 20px;
            flex-shrink: 0;
        }
        
        .rule-content h4 {
            margin-bottom: 8px;
        }
        
        .interactive-controls {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        
        .interactive-controls label {
            display: block;
            margin: 10px 0 5px;
            font-weight: bold;
        }
        
        .interactive-controls input[type="range"] {
            width: 100%;
        }
        
        .interactive-controls .value-display {
            text-align: center;
            font-family: monospace;
            margin-top: 5px;
        }
        
        footer {
            text-align: center;
            padding: 30px;
            color: var(--color-muted);
        }
        
        .tab-container {
            margin-top: 20px;
        }
        
        .tab-buttons {
            display: flex;
            gap: 5px;
            margin-bottom: 0;
        }
        
        .tab-btn {
            padding: 10px 20px;
            border: none;
            background: #e0e0e0;
            cursor: pointer;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .tab-btn.active {
            background: var(--color-transform);
            color: white;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            background: white;
            border-radius: 0 8px 8px 8px;
            border: 2px solid #e0e0e0;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üî¢ The Four Views of Linear Algebra</h1>
            <p>Equations ¬∑ Columns ¬∑ Transformations ¬∑ Metrics ‚Äî All Unified</p>
        </header>
        
        <!-- Introduction -->
        <div class="intro-box">
            <h2>One System, Four Perspectives</h2>
            <p>A matrix is not just a grid of numbers ‚Äî it represents <strong>four equivalent ways</strong> of understanding the same mathematical object. This guide shows how solving a system of equations, finding linear combinations, transforming space, and measuring length are all connected through the same eigenvalues and eigenvectors.</p>
            
            <div class="system-display">
                <strong>Our Example System:</strong><br><br>
                2x + y = 5<br>
                x - y = 1<br><br>
                <strong>Solution: x = 2, y = 1</strong>
            </div>
            
            <p>We'll explore this system from all four viewpoints and see how each reveals different geometric and algebraic insights.</p>
        </div>
        
        <!-- VIEW 1: ROW PICTURE -->
        <div class="view-section">
            <div class="view-header row">
                VIEW 1: The Row Picture ‚Äî Each Equation is a Line
            </div>
            <div class="view-content">
                <div class="visualization">
                    <canvas id="rowCanvas" width="400" height="350"></canvas>
                </div>
                <div class="explanation">
                    <h3>The Geometry of Equations</h3>
                    <p>Each equation in the system defines a <strong>line</strong> (in 2D) or a <strong>hyperplane</strong> (in higher dimensions). The solution is the point where all lines intersect.</p>
                    
                    <div class="formula-box">
                        <strong>Equation 1:</strong> 2x + y = 5<br>
                        ‚Üí y = 5 - 2x (slope = -2)<br><br>
                        <strong>Equation 2:</strong> x - y = 1<br>
                        ‚Üí y = x - 1 (slope = 1)
                    </div>
                    
                    <div class="step-box highlight">
                        <strong>Solution:</strong> The lines intersect at (2, 1)<br>
                        Check: 2(2) + 1 = 5 ‚úì and 2 - 1 = 1 ‚úì
                    </div>
                    
                    <p><strong>Key Insight:</strong> The row picture shows us that solving equations means finding where geometric objects intersect. In 3D, three planes intersect at a point; in higher dimensions, hyperplanes intersect.</p>
                </div>
            </div>
        </div>
        
        <!-- VIEW 2: COLUMN PICTURE -->
        <div class="view-section">
            <div class="view-header column">
                VIEW 2: The Column Picture ‚Äî Linear Combination of Vectors
            </div>
            <div class="view-content">
                <div class="visualization">
                    <canvas id="columnCanvas" width="400" height="350"></canvas>
                </div>
                <div class="explanation">
                    <h3>The Geometry of Columns</h3>
                    <p>Rewrite the system as a <strong>linear combination</strong> of column vectors:</p>
                    
                    <div class="formula-box">
                        x ¬∑ <span style="color: var(--color-row1)">[2, 1]</span> + y ¬∑ <span style="color: var(--color-row2)">[1, -1]</span> = <span style="color: var(--color-solution)">[5, 1]</span>
                    </div>
                    
                    <p>The question becomes: <em>"What combination of the column vectors reaches the target b?"</em></p>
                    
                    <div class="step-box">
                        <strong>Column 1:</strong> a‚ÇÅ = [2, 1]·µÄ<br>
                        <strong>Column 2:</strong> a‚ÇÇ = [1, -1]·µÄ<br>
                        <strong>Target:</strong> b = [5, 1]·µÄ
                    </div>
                    
                    <div class="step-box highlight">
                        <strong>Solution:</strong> 2¬∑a‚ÇÅ + 1¬∑a‚ÇÇ = b<br>
                        2¬∑[2,1] + 1¬∑[1,-1] = [4+1, 2-1] = [5, 1] ‚úì
                    </div>
                    
                    <p><strong>Key Insight:</strong> The solution coefficients (x=2, y=1) are the coordinates of b in the basis formed by the columns of A!</p>
                </div>
            </div>
        </div>
        
        <!-- VIEW 3: TRANSFORMATION PICTURE -->
        <div class="view-section">
            <div class="view-header transform">
                VIEW 3: The Transformation Picture ‚Äî Finding the Pre-Image
            </div>
            <div class="view-content">
                <div class="visualization">
                    <canvas id="transformCanvas" width="400" height="350"></canvas>
                </div>
                <div class="explanation">
                    <h3>The Geometry of Transformations</h3>
                    <p>The matrix A <strong>transforms</strong> every vector x to a new vector Ax. Solving Ax = b asks: <em>"What x gets mapped to b?"</em></p>
                    
                    <div class="formula-box">
                        A = <span class="matrix-bracket">[<span class="matrix-content cols-2"><span>2</span><span>1</span><span>1</span><span>-1</span></span>]</span>
                        transforms x ‚Üí Ax
                    </div>
                    
                    <div class="step-box">
                        <strong>The transformation:</strong><br>
                        ‚Ä¢ Unit square ‚Üí Parallelogram<br>
                        ‚Ä¢ Circles ‚Üí Ellipses<br>
                        ‚Ä¢ Eigenvalues control the stretch
                    </div>
                    
                    <div class="step-box highlight">
                        <strong>Solution:</strong> x = A‚Åª¬πb<br>
                        The inverse A‚Åª¬π "undoes" the transformation<br>
                        [2, 1]·µÄ is the pre-image of [5, 1]·µÄ
                    </div>
                    
                    <p><strong>Key Insight:</strong> Solving equations is equivalent to reversing a transformation. A‚Åª¬π stretches by 1/Œª along each eigenvector direction.</p>
                </div>
            </div>
        </div>
        
        <!-- VIEW 4: METRIC PICTURE -->
        <div class="view-section">
            <div class="view-header metric">
                VIEW 4: The Metric Picture ‚Äî Measuring Length with Matrices
            </div>
            <div class="view-content">
                <div class="visualization">
                    <canvas id="metricCanvas" width="400" height="350"></canvas>
                    <div class="interactive-controls">
                        <label>Rotate direction Œ≤:</label>
                        <input type="range" id="betaAngle" min="0" max="360" value="45">
                        <div class="value-display" id="betaValue">Œ∏ = 45¬∞, Œ≤'Œ£Œ≤ = 0.85</div>
                    </div>
                </div>
                <div class="explanation">
                    <h3>The Geometry of Metrics</h3>
                    <p>For a <strong>symmetric positive-definite matrix</strong> Œ£ (like a covariance matrix), the quadratic form x'Œ£x defines a way to measure "length".</p>
                    
                    <div class="formula-box">
                        ||x||¬≤<sub>Œ£</sub> = x'Œ£x<br><br>
                        The ellipse x'Œ£‚Åª¬πx = 1 is the "unit ball"
                    </div>
                    
                    <div class="step-box">
                        <strong>For our symmetric example:</strong><br>
                        Œ£ = [1.5, 0.5; 0.5, 1.2]<br>
                        Eigenvalues: Œª‚ÇÅ ‚âà 0.89, Œª‚ÇÇ ‚âà 1.81<br>
                        These are lengths¬≤ along principal axes
                    </div>
                    
                    <div class="step-box highlight">
                        <strong>Key Insight:</strong><br>
                        ‚Ä¢ Eigenvalues = squared lengths along eigenvectors<br>
                        ‚Ä¢ Œ≤'Œ£Œ≤ = weighted average of eigenvalues<br>
                        ‚Ä¢ The ellipse encodes all directional lengths
                    </div>
                    
                    <p><strong>For Quantitative Genetics:</strong> G and P matrices are metrics. h¬≤(Œ≤) = Œ≤'GŒ≤ / Œ≤'PŒ≤ compares two rulers!</p>
                </div>
            </div>
        </div>
        
        <!-- UNIFIED VIEW -->
        <div class="unified-section">
            <h2>üîó The Grand Unification</h2>
            
            <div class="four-views-grid">
                <div class="view-card row">
                    <h4>Row Picture</h4>
                    <p>Each row = hyperplane</p>
                    <p>Solution = intersection</p>
                    <p><em>Classic "solve equations"</em></p>
                </div>
                <div class="view-card column">
                    <h4>Column Picture</h4>
                    <p>Columns = basis vectors</p>
                    <p>Solution = coordinates in basis</p>
                    <p><em>"What combination gives b?"</em></p>
                </div>
                <div class="view-card transform">
                    <h4>Transformation</h4>
                    <p>Matrix = space deformation</p>
                    <p>Solution = pre-image of b</p>
                    <p><em>"What maps to b under A?"</em></p>
                </div>
                <div class="view-card metric">
                    <h4>Metric</h4>
                    <p>Matrix = length definition</p>
                    <p>Ellipse = unit ball</p>
                    <p><em>"How to measure distance"</em></p>
                </div>
            </div>
            
            <h3 style="text-align: center; margin: 30px 0 20px;">Eigenvalues Across All Views</h3>
            
            <table class="eigenvalue-table">
                <tr>
                    <th>View</th>
                    <th>What Œª·µ¢ Means</th>
                    <th>Geometric Interpretation</th>
                </tr>
                <tr>
                    <td><strong>Row</strong></td>
                    <td>Condition number = Œª‚Çò‚Çê‚Çì/Œª‚Çò·µ¢‚Çô</td>
                    <td>Numerical stability of solution</td>
                </tr>
                <tr>
                    <td><strong>Column</strong></td>
                    <td>Œª = 0 means dependent columns</td>
                    <td>Dimensionality of column space</td>
                </tr>
                <tr>
                    <td><strong>Transform</strong></td>
                    <td>Stretch factor along eigenvector</td>
                    <td>How much each axis expands/contracts</td>
                </tr>
                <tr>
                    <td><strong>Metric</strong></td>
                    <td>Squared length along eigenvector</td>
                    <td>Directional variance (for covariance)</td>
                </tr>
            </table>
            
            <div class="key-insight">
                <p>All four views give the SAME solution.<br>
                Eigenvalues are the thread connecting them all!</p>
            </div>
        </div>
        
        <!-- RULES OF LINEAR ALGEBRA -->
        <div class="rules-section">
            <h2>üìê Core Rules of Linear Algebra</h2>
            
            <div class="tab-container">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="showTab('basic')">Basic Operations</button>
                    <button class="tab-btn" onclick="showTab('inverse')">Inverse & Solving</button>
                    <button class="tab-btn" onclick="showTab('eigen')">Eigenvalues</button>
                    <button class="tab-btn" onclick="showTab('quadratic')">Quadratic Forms</button>
                </div>
                
                <div id="basic" class="tab-content active">
                    <div class="rule-item">
                        <div class="rule-number">1</div>
                        <div class="rule-content">
                            <h4>Matrix-Vector Multiplication</h4>
                            <p>Ax combines columns: Ax = x‚ÇÅ(col 1) + x‚ÇÇ(col 2) + ...</p>
                            <div class="formula-box">
                                [2 1; 1 -1] ¬∑ [2; 1] = 2¬∑[2; 1] + 1¬∑[1; -1] = [5; 1]
                            </div>
                        </div>
                    </div>
                    
                    <div class="rule-item">
                        <div class="rule-number">2</div>
                        <div class="rule-content">
                            <h4>Matrix-Matrix Multiplication</h4>
                            <p>AB: each column of B is transformed by A</p>
                            <div class="formula-box">
                                (AB)·µ¢‚±º = (row i of A) ¬∑ (col j of B) = Œ£‚Çñ A·µ¢‚Çñ B‚Çñ‚±º
                            </div>
                        </div>
                    </div>
                    
                    <div class="rule-item">
                        <div class="rule-number">3</div>
                        <div class="rule-content">
                            <h4>Transpose</h4>
                            <p>Flip rows and columns: (A·µÄ)·µ¢‚±º = A‚±º·µ¢</p>
                            <div class="formula-box">
                                [2 1; 1 -1]·µÄ = [2 1; 1 -1] (symmetric!)<br>
                                (AB)·µÄ = B·µÄA·µÄ (order reverses)
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="inverse" class="tab-content">
                    <div class="rule-item">
                        <div class="rule-number">4</div>
                        <div class="rule-content">
                            <h4>Matrix Inverse</h4>
                            <p>A‚Åª¬πA = AA‚Åª¬π = I (identity matrix)</p>
                            <div class="formula-box">
                                For 2√ó2: A = [a b; c d]<br>
                                A‚Åª¬π = (1/det(A)) ¬∑ [d -b; -c a]<br>
                                det(A) = ad - bc
                            </div>
                        </div>
                    </div>
                    
                    <div class="rule-item">
                        <div class="rule-number">5</div>
                        <div class="rule-content">
                            <h4>Solving Ax = b</h4>
                            <p>If det(A) ‚â† 0: unique solution x = A‚Åª¬πb</p>
                            <div class="formula-box">
                                A = [2 1; 1 -1], det(A) = -2 - 1 = -3 ‚â† 0 ‚úì<br>
                                A‚Åª¬π = (-1/3)[‚àí1 ‚àí1; ‚àí1 2] = [1/3 1/3; 1/3 -2/3]<br>
                                x = A‚Åª¬π[5; 1] = [2; 1] ‚úì
                            </div>
                        </div>
                    </div>
                    
                    <div class="rule-item">
                        <div class="rule-number">6</div>
                        <div class="rule-content">
                            <h4>Determinant Geometry</h4>
                            <p>|det(A)| = area/volume of transformed unit square/cube</p>
                            <div class="formula-box">
                                det(A) = 0 ‚Üí singular (no inverse)<br>
                                det(A) > 0 ‚Üí preserves orientation<br>
                                det(A) < 0 ‚Üí reverses orientation
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="eigen" class="tab-content">
                    <div class="rule-item">
                        <div class="rule-number">7</div>
                        <div class="rule-content">
                            <h4>Eigenvalue Definition</h4>
                            <p>Av = Œªv ‚Äî eigenvector v only gets scaled, not rotated</p>
                            <div class="formula-box">
                                Find Œª: det(A - ŒªI) = 0 (characteristic equation)<br>
                                Find v: solve (A - ŒªI)v = 0
                            </div>
                        </div>
                    </div>
                    
                    <div class="rule-item">
                        <div class="rule-number">8</div>
                        <div class="rule-content">
                            <h4>Spectral Decomposition</h4>
                            <p>For symmetric A: A = VŒõV·µÄ where V = eigenvectors, Œõ = diag(eigenvalues)</p>
                            <div class="formula-box">
                                A = Œª‚ÇÅv‚ÇÅv‚ÇÅ·µÄ + Œª‚ÇÇv‚ÇÇv‚ÇÇ·µÄ + ...<br>
                                Each term is a "rank-1" matrix in eigenvector direction
                            </div>
                        </div>
                    </div>
                    
                    <div class="rule-item">
                        <div class="rule-number">9</div>
                        <div class="rule-content">
                            <h4>Eigenvalue Properties</h4>
                            <p>Eigenvalues encode key information about the matrix</p>
                            <div class="formula-box">
                                det(A) = Œª‚ÇÅ √ó Œª‚ÇÇ √ó ... √ó Œª‚Çô<br>
                                trace(A) = Œª‚ÇÅ + Œª‚ÇÇ + ... + Œª‚Çô<br>
                                Eigenvalues of A‚Åª¬π are 1/Œª·µ¢
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="quadratic" class="tab-content">
                    <div class="rule-item">
                        <div class="rule-number">10</div>
                        <div class="rule-content">
                            <h4>Quadratic Form</h4>
                            <p>x'Ax is a scalar that depends on direction and matrix</p>
                            <div class="formula-box">
                                x'Ax = Œ£·µ¢‚±º A·µ¢‚±º x·µ¢ x‚±º<br>
                                For unit vector Œ≤: Œ≤'AŒ≤ = weighted avg of eigenvalues<br>
                                Œ≤'AŒ≤ = Œ£·µ¢ Œª·µ¢ (Œ≤¬∑v·µ¢)¬≤
                            </div>
                        </div>
                    </div>
                    
                    <div class="rule-item">
                        <div class="rule-number">11</div>
                        <div class="rule-content">
                            <h4>The Ellipse Connection</h4>
                            <p>x'A‚Åª¬πx = 1 defines an ellipse (for positive definite A)</p>
                            <div class="formula-box">
                                Semi-axes have length ‚àöŒª·µ¢ along eigenvector v·µ¢<br>
                                This is the "unit ball" of the A-metric<br>
                                Eigenvalue spread ‚Üí ellipse eccentricity
                            </div>
                        </div>
                    </div>
                    
                    <div class="rule-item">
                        <div class="rule-number">12</div>
                        <div class="rule-content">
                            <h4>Rayleigh Quotient</h4>
                            <p>R(x) = x'Ax / x'x ‚Äî ratio of quadratic forms</p>
                            <div class="formula-box">
                                Œª‚Çò·µ¢‚Çô ‚â§ R(x) ‚â§ Œª‚Çò‚Çê‚Çì for any x<br>
                                R(v·µ¢) = Œª·µ¢ (eigenvectors give eigenvalues)<br>
                                This is the foundation of h¬≤(Œ≤) = Œ≤'GŒ≤ / Œ≤'PŒ≤!
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- CONNECTION TO GENETICS -->
        <div class="genetics-section">
            <h2>üß¨ Connection to Quantitative Genetics</h2>
            
            <p>The breeder's equation <strong>ŒîzÃÑ = GP‚Åª¬πS</strong> combines all four views:</p>
            
            <div class="four-views-grid">
                <div class="view-card transform">
                    <h4>Œ≤ = P‚Åª¬πS</h4>
                    <p><strong>Solving the equation</strong> PŒ≤ = S</p>
                    <p>Convert selection differential to gradient</p>
                </div>
                <div class="view-card transform">
                    <h4>ŒîzÃÑ = GŒ≤</h4>
                    <p><strong>Transformation</strong> by G</p>
                    <p>Genetic architecture shapes response</p>
                </div>
                <div class="view-card metric">
                    <h4>G and P as metrics</h4>
                    <p><strong>Two different rulers</strong></p>
                    <p>Measure genetic vs phenotypic length</p>
                </div>
                <div class="view-card metric">
                    <h4>h¬≤(Œ≤) = Œ≤'GŒ≤ / Œ≤'PŒ≤</h4>
                    <p><strong>Ratio of metrics</strong></p>
                    <p>Directional heritability</p>
                </div>
            </div>
            
            <div class="key-insight">
                <p>CV(h¬≤) = ‚àö(2V_rel/(p+2))<br><br>
                Eigenvalue dispersion of G* controls how much h¬≤ varies with direction.<br>
                High V_rel = constraint traps in some directions!</p>
            </div>
        </div>
        
        <footer>
            <p>Created by Daniel Ortiz-Barrientos & Claude | The Geometry of Evolvability Project</p>
            <p>Download this file and open in any browser to use offline.</p>
        </footer>
    </div>
    
    <script>
        // ===================================================================
        // VISUALIZATION CODE
        // ===================================================================
        
        // Helper functions
        function drawArrow(ctx, fromX, fromY, toX, toY, color, lineWidth = 2) {
            const headLen = 10;
            const dx = toX - fromX;
            const dy = toY - fromY;
            const angle = Math.atan2(dy, dx);
            
            ctx.strokeStyle = color;
            ctx.lineWidth = lineWidth;
            ctx.beginPath();
            ctx.moveTo(fromX, fromY);
            ctx.lineTo(toX, toY);
            ctx.stroke();
            
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.moveTo(toX, toY);
            ctx.lineTo(toX - headLen * Math.cos(angle - Math.PI / 6), 
                      toY - headLen * Math.sin(angle - Math.PI / 6));
            ctx.lineTo(toX - headLen * Math.cos(angle + Math.PI / 6), 
                      toY - headLen * Math.sin(angle + Math.PI / 6));
            ctx.closePath();
            ctx.fill();
        }
        
        function toCanvas(x, y, canvas, scale, offsetX, offsetY) {
            return [offsetX + x * scale, offsetY - y * scale];
        }
        
        // ===================================================================
        // VIEW 1: ROW PICTURE
        // ===================================================================
        function drawRowPicture() {
            const canvas = document.getElementById('rowCanvas');
            const ctx = canvas.getContext('2d');
            const w = canvas.width, h = canvas.height;
            
            ctx.clearRect(0, 0, w, h);
            
            const scale = 60;
            const offsetX = 80;
            const offsetY = h - 60;
            
            // Draw axes
            ctx.strokeStyle = '#999';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(offsetX, 20);
            ctx.lineTo(offsetX, offsetY);
            ctx.lineTo(w - 20, offsetY);
            ctx.stroke();
            
            // Axis labels
            ctx.fillStyle = '#333';
            ctx.font = '14px sans-serif';
            ctx.fillText('x', w - 30, offsetY + 20);
            ctx.fillText('y', offsetX - 20, 30);
            
            // Grid
            ctx.strokeStyle = '#eee';
            for (let i = -1; i <= 5; i++) {
                const [gx, gy] = toCanvas(i, 0, canvas, scale, offsetX, offsetY);
                ctx.beginPath();
                ctx.moveTo(gx, 20);
                ctx.lineTo(gx, offsetY);
                ctx.stroke();
                if (i >= 0) {
                    ctx.fillStyle = '#999';
                    ctx.fillText(i.toString(), gx - 5, offsetY + 15);
                }
            }
            for (let i = -1; i <= 4; i++) {
                const [gx, gy] = toCanvas(0, i, canvas, scale, offsetX, offsetY);
                ctx.beginPath();
                ctx.moveTo(offsetX, gy);
                ctx.lineTo(w - 20, gy);
                ctx.stroke();
                if (i !== 0) {
                    ctx.fillStyle = '#999';
                    ctx.fillText(i.toString(), offsetX - 20, gy + 5);
                }
            }
            
            // Line 1: 2x + y = 5 => y = 5 - 2x
            ctx.strokeStyle = '#2E86AB';
            ctx.lineWidth = 3;
            ctx.beginPath();
            const [l1x1, l1y1] = toCanvas(-0.5, 5 - 2*(-0.5), canvas, scale, offsetX, offsetY);
            const [l1x2, l1y2] = toCanvas(4, 5 - 2*4, canvas, scale, offsetX, offsetY);
            ctx.moveTo(l1x1, l1y1);
            ctx.lineTo(l1x2, l1y2);
            ctx.stroke();
            
            // Line 2: x - y = 1 => y = x - 1
            ctx.strokeStyle = '#E63946';
            ctx.lineWidth = 3;
            ctx.beginPath();
            const [l2x1, l2y1] = toCanvas(-0.5, -0.5 - 1, canvas, scale, offsetX, offsetY);
            const [l2x2, l2y2] = toCanvas(4.5, 4.5 - 1, canvas, scale, offsetX, offsetY);
            ctx.moveTo(l2x1, l2y1);
            ctx.lineTo(l2x2, l2y2);
            ctx.stroke();
            
            // Solution point
            const [sx, sy] = toCanvas(2, 1, canvas, scale, offsetX, offsetY);
            ctx.fillStyle = '#F18F01';
            ctx.beginPath();
            ctx.arc(sx, sy, 10, 0, 2 * Math.PI);
            ctx.fill();
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // Labels
            ctx.font = 'bold 14px sans-serif';
            ctx.fillStyle = '#2E86AB';
            ctx.fillText('2x + y = 5', 20, 40);
            ctx.fillStyle = '#E63946';
            ctx.fillText('x - y = 1', 20, 60);
            ctx.fillStyle = '#F18F01';
            ctx.fillText('Solution (2, 1)', sx + 15, sy - 10);
        }
        
        // ===================================================================
        // VIEW 2: COLUMN PICTURE
        // ===================================================================
        function drawColumnPicture() {
            const canvas = document.getElementById('columnCanvas');
            const ctx = canvas.getContext('2d');
            const w = canvas.width, h = canvas.height;
            
            ctx.clearRect(0, 0, w, h);
            
            const scale = 45;
            const offsetX = 80;
            const offsetY = h - 80;
            
            // Draw axes
            ctx.strokeStyle = '#999';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(offsetX, 20);
            ctx.lineTo(offsetX, offsetY + 40);
            ctx.lineTo(w - 20, offsetY + 40);
            ctx.stroke();
            
            // Column 1: [2, 1]
            const [c1x, c1y] = toCanvas(2, 1, canvas, scale, offsetX, offsetY);
            drawArrow(ctx, offsetX, offsetY, c1x, c1y, '#2E86AB', 3);
            ctx.fillStyle = '#2E86AB';
            ctx.font = 'bold 12px sans-serif';
            ctx.fillText('a‚ÇÅ = [2, 1]', c1x + 5, c1y - 10);
            
            // Column 2: [1, -1]
            const [c2x, c2y] = toCanvas(1, -1, canvas, scale, offsetX, offsetY);
            drawArrow(ctx, offsetX, offsetY, c2x, c2y, '#E63946', 3);
            ctx.fillStyle = '#E63946';
            ctx.fillText('a‚ÇÇ = [1, -1]', c2x + 5, c2y + 20);
            
            // Scaled column 1: 2*[2,1] = [4, 2]
            const [sc1x, sc1y] = toCanvas(4, 2, canvas, scale, offsetX, offsetY);
            drawArrow(ctx, offsetX, offsetY, sc1x, sc1y, '#2E86AB', 2);
            ctx.fillStyle = '#2E86AB';
            ctx.fillText('2¬∑a‚ÇÅ', sc1x - 30, sc1y - 10);
            
            // Scaled column 2 starting from end of scaled column 1
            const [sc2x, sc2y] = toCanvas(5, 1, canvas, scale, offsetX, offsetY);
            drawArrow(ctx, sc1x, sc1y, sc2x, sc2y, '#E63946', 2);
            ctx.fillStyle = '#E63946';
            ctx.fillText('1¬∑a‚ÇÇ', (sc1x + sc2x)/2 + 10, (sc1y + sc2y)/2 - 15);
            
            // Target b = [5, 1]
            const [bx, by] = toCanvas(5, 1, canvas, scale, offsetX, offsetY);
            ctx.setLineDash([5, 5]);
            drawArrow(ctx, offsetX, offsetY, bx, by, '#F18F01', 2);
            ctx.setLineDash([]);
            
            ctx.fillStyle = '#F18F01';
            ctx.beginPath();
            ctx.arc(bx, by, 8, 0, 2 * Math.PI);
            ctx.fill();
            ctx.fillText('b = [5, 1]', bx + 10, by);
            
            // Legend
            ctx.font = '12px sans-serif';
            ctx.fillStyle = '#333';
            ctx.fillText('Solution: 2¬∑a‚ÇÅ + 1¬∑a‚ÇÇ = b', 20, 30);
        }
        
        // ===================================================================
        // VIEW 3: TRANSFORMATION PICTURE
        // ===================================================================
        function drawTransformPicture() {
            const canvas = document.getElementById('transformCanvas');
            const ctx = canvas.getContext('2d');
            const w = canvas.width, h = canvas.height;
            
            ctx.clearRect(0, 0, w, h);
            
            const scale = 50;
            const offsetX = w / 2 - 40;
            const offsetY = h / 2 + 30;
            
            // Matrix A = [2 1; 1 -1]
            const A = [[2, 1], [1, -1]];
            
            function transform(x, y) {
                return [A[0][0]*x + A[0][1]*y, A[1][0]*x + A[1][1]*y];
            }
            
            // Draw axes
            ctx.strokeStyle = '#ccc';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(20, offsetY);
            ctx.lineTo(w - 20, offsetY);
            ctx.moveTo(offsetX, 20);
            ctx.lineTo(offsetX, h - 20);
            ctx.stroke();
            
            // Original unit square (dashed)
            ctx.strokeStyle = '#999';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            const sq = [[0,0], [1,0], [1,1], [0,1], [0,0]];
            sq.forEach((p, i) => {
                const [cx, cy] = toCanvas(p[0], p[1], canvas, scale, offsetX, offsetY);
                if (i === 0) ctx.moveTo(cx, cy);
                else ctx.lineTo(cx, cy);
            });
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Transformed parallelogram
            ctx.strokeStyle = '#762A83';
            ctx.fillStyle = 'rgba(118, 42, 131, 0.2)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            sq.forEach((p, i) => {
                const [tx, ty] = transform(p[0], p[1]);
                const [cx, cy] = toCanvas(tx, ty, canvas, scale, offsetX, offsetY);
                if (i === 0) ctx.moveTo(cx, cy);
                else ctx.lineTo(cx, cy);
            });
            ctx.fill();
            ctx.stroke();
            
            // Solution point x = [2, 1]
            const [xx, xy] = toCanvas(2, 1, canvas, scale, offsetX, offsetY);
            ctx.fillStyle = '#1B7837';
            ctx.beginPath();
            ctx.arc(xx, xy, 8, 0, 2 * Math.PI);
            ctx.fill();
            
            // Target b = [5, 1]
            const [bx, by] = toCanvas(5, 1, canvas, scale, offsetX, offsetY);
            ctx.fillStyle = '#F18F01';
            ctx.beginPath();
            ctx.arc(bx, by, 8, 0, 2 * Math.PI);
            ctx.fill();
            
            // Draw transformation arrow
            ctx.strokeStyle = '#762A83';
            ctx.lineWidth = 2;
            const midX = (xx + bx) / 2;
            const midY = (xy + by) / 2 - 30;
            ctx.beginPath();
            ctx.moveTo(xx + 15, xy - 10);
            ctx.quadraticCurveTo(midX, midY, bx - 15, by - 10);
            ctx.stroke();
            
            // Arrowhead
            ctx.fillStyle = '#762A83';
            ctx.beginPath();
            ctx.moveTo(bx - 15, by - 10);
            ctx.lineTo(bx - 25, by - 15);
            ctx.lineTo(bx - 20, by - 5);
            ctx.closePath();
            ctx.fill();
            
            // Labels
            ctx.font = 'bold 12px sans-serif';
            ctx.fillStyle = '#1B7837';
            ctx.fillText('x = [2, 1]', xx - 40, xy + 25);
            ctx.fillStyle = '#F18F01';
            ctx.fillText('b = [5, 1]', bx + 10, by + 5);
            ctx.fillStyle = '#762A83';
            ctx.fillText('A', midX - 5, midY - 10);
            
            ctx.font = '11px sans-serif';
            ctx.fillStyle = '#999';
            ctx.fillText('Unit square', 20, 30);
            ctx.fillStyle = '#762A83';
            ctx.fillText('Transformed', 20, 50);
        }
        
        // ===================================================================
        // VIEW 4: METRIC PICTURE
        // ===================================================================
        let currentAngle = 45;
        
        function drawMetricPicture() {
            const canvas = document.getElementById('metricCanvas');
            const ctx = canvas.getContext('2d');
            const w = canvas.width, h = canvas.height;
            
            ctx.clearRect(0, 0, w, h);
            
            const scale = 80;
            const offsetX = w / 2;
            const offsetY = h / 2;
            
            // Symmetric matrix Œ£ = [1.5, 0.5; 0.5, 1.2]
            const Sigma = [[1.5, 0.5], [0.5, 1.2]];
            
            // Eigendecomposition (pre-computed)
            const lambda1 = 0.8854;
            const lambda2 = 1.8146;
            const v1 = [-0.6455, 0.7637];  // eigenvector for lambda1
            const v2 = [0.7637, 0.6455];   // eigenvector for lambda2
            
            // Draw axes
            ctx.strokeStyle = '#ccc';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(20, offsetY);
            ctx.lineTo(w - 20, offsetY);
            ctx.moveTo(offsetX, 20);
            ctx.lineTo(offsetX, h - 20);
            ctx.stroke();
            
            // Draw unit circle (for reference)
            ctx.strokeStyle = '#ddd';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.arc(offsetX, offsetY, scale, 0, 2 * Math.PI);
            ctx.stroke();
            
            // Draw ellipse x'Œ£‚Åª¬πx = 1
            // Semi-axes are sqrt(lambda_i) along eigenvector directions
            ctx.strokeStyle = '#2E86AB';
            ctx.fillStyle = 'rgba(46, 134, 171, 0.2)';
            ctx.lineWidth = 3;
            
            const angle = Math.atan2(v2[1], v2[0]);
            const a = Math.sqrt(lambda2) * scale;  // semi-major
            const b = Math.sqrt(lambda1) * scale;  // semi-minor
            
            ctx.beginPath();
            ctx.ellipse(offsetX, offsetY, a, b, -angle, 0, 2 * Math.PI);
            ctx.fill();
            ctx.stroke();
            
            // Draw eigenvectors
            const ev1x = v1[0] * Math.sqrt(lambda1) * scale;
            const ev1y = -v1[1] * Math.sqrt(lambda1) * scale;
            const ev2x = v2[0] * Math.sqrt(lambda2) * scale;
            const ev2y = -v2[1] * Math.sqrt(lambda2) * scale;
            
            drawArrow(ctx, offsetX, offsetY, offsetX + ev1x, offsetY + ev1y, '#E63946', 2);
            drawArrow(ctx, offsetX, offsetY, offsetX + ev2x, offsetY + ev2y, '#1B7837', 2);
            
            // Draw direction Œ≤
            const betaRad = currentAngle * Math.PI / 180;
            const betaX = Math.cos(betaRad);
            const betaY = Math.sin(betaRad);
            
            // Compute Œ≤'Œ£Œ≤
            const betaSigmaBeta = Sigma[0][0]*betaX*betaX + 2*Sigma[0][1]*betaX*betaY + Sigma[1][1]*betaY*betaY;
            
            // Draw Œ≤ vector
            const bLen = scale * 1.3;
            drawArrow(ctx, offsetX, offsetY, 
                     offsetX + betaX * bLen, offsetY - betaY * bLen, 
                     '#F18F01', 3);
            
            // Labels
            ctx.font = 'bold 11px sans-serif';
            ctx.fillStyle = '#E63946';
            ctx.fillText(`Œª‚ÇÅ=${lambda1.toFixed(2)}`, offsetX + ev1x + 5, offsetY + ev1y);
            ctx.fillStyle = '#1B7837';
            ctx.fillText(`Œª‚ÇÇ=${lambda2.toFixed(2)}`, offsetX + ev2x + 5, offsetY + ev2y - 10);
            ctx.fillStyle = '#F18F01';
            ctx.fillText('Œ≤', offsetX + betaX * bLen + 10, offsetY - betaY * bLen);
            
            ctx.font = '12px sans-serif';
            ctx.fillStyle = '#2E86AB';
            ctx.fillText("x'Œ£‚Åª¬πx = 1 (ellipse)", 20, 25);
            ctx.fillStyle = '#ddd';
            ctx.fillText('Unit circle', 20, 45);
            
            // Update display
            document.getElementById('betaValue').textContent = 
                `Œ∏ = ${currentAngle}¬∞, Œ≤'Œ£Œ≤ = ${betaSigmaBeta.toFixed(3)}`;
        }
        
        // Slider interaction
        document.getElementById('betaAngle').addEventListener('input', function(e) {
            currentAngle = parseInt(e.target.value);
            drawMetricPicture();
        });
        
        // ===================================================================
        // TAB FUNCTIONALITY
        // ===================================================================
        function showTab(tabId) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }
        
        // ===================================================================
        // INITIALIZE
        // ===================================================================
        window.onload = function() {
            drawRowPicture();
            drawColumnPicture();
            drawTransformPicture();
            drawMetricPicture();
        };
    </script>
</body>
</html>
